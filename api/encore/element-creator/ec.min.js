/* -----------------------------------------------
/* Author : NATSKI - natski.net
/* MIT license : https://opensource.org/license/MIT
/* GitHub : https://github.com/natspooky/encore
/* How to use? : Check the GitHub README or visit https://natski.net/api/encore/element-creator
/* ----------------------------------------------- */

export function jsonElementify(e){if(Array.isArray(e))return jsonMultiElementify(e);let t=document.createElement(e.tag);if(!t)throw Error("an invalid TAG has been applied");return e.innerHTML&&(t.innerHTML=e.innerHTML),e.classes&&(Array.isArray(e.classes)?e.classes.forEach(e=>{t.classList.add(e)}):e.classes.split(" ").forEach(e=>{t.classList.add(e)})),e.events&&Object.entries(e.events).forEach(([e,n])=>{n&&t.addEventListener(e,functionType(n,t),n.options)}),e.attributes&&Object.entries(e.attributes).forEach(([e,n])=>{checkExists(n)&&t.setAttribute(e,n)}),e.dataset&&Object.entries(e.dataset).forEach(([e,n])=>{checkExists(n)&&(t.dataset[e.split("-").map((e,t)=>t?e.slice(0,1).toUpperCase()+e.slice(1):e).join("")]=n)}),e.children&&appendChildren(t,jsonElementify(e.children)),t}export function appendChildren(e,t){if(Array.isArray(t))for(let n of t)e.appendChild(n);else e.appendChild(t)}export function insertChildrenBefore(e,t,n){if(Array.isArray(t))for(let r of t)e.insertBefore(r,n);else e.insertBefore(t,n)}function jsonMultiElementify(e){let t=[];return e.forEach(e=>{checkForKeys(e)&&t.push(jsonElementify(e))}),t}function checkForKeys(e){return 0!==Object.keys(e).length&&e.constructor===Object}function functionType(e,t){return checkExists(e.var)?Array.isArray(e.var)&&e.var.length>1?"self"===e.var[0]?()=>e.func(t,...e.var.slice(1)):"event"===e.var[0]?t=>e.func(t,...e.var.slice(1)):()=>e.func(...e.var):(Array.isArray(e.var)&&(e.var=e.var[0]),"self"===e.var)?()=>e.func(t):"event"===e.var?t=>e.func(t):()=>e.func(e.var):()=>e.func()}export function checkExists(e){return null!=e}export function setFallback(e,t){return checkExists(e)?e:t}export function elementJsonify(e){let t={};if(t.tag=e.tagName,e.attributes)for(let n of(t.attributes={},e.attributes))"class"!==n.nodeName&&(t.attributes[n.nodeName]=n.nodeValue);if(e.className&&(t.classes=e.className.split(" ")),e.children.length>0)for(let r of(t.children=[],e.children))t.children.push(elementJsonify(r));else t.innerHTML=e.innerHTML;return t}